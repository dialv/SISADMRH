<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head lang="en">
        <title>Crear Usuario</title>
    <th:block th:include="../templates/header"></th:block>
</head>
<body>
    <div class="row">
        <div class="col-md-3">
            <th:block th:include="../templates/menu"></th:block>
        </div>
        <div class="col-md-9">
            <br><br>
            <div class="row text-center">
                <img src="../../static/image/agregarusuario.png" width="150" th:src="@{/image/agregarusuario.png}"/>
            </div>
            <br>
            <div>
                <form id ="usuarioform" class="form-horizontal" th:object="${usuario}" th:action="@{../usuario}" method="post" >
                    <h3>Introduzca los datos del Usuario</h3>

                    <input type="hidden" th:field="*{codigousuario}"/>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Nombres:</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control letras" required="true" size="100" maxlength="50" th:field="*{nombrecompleto}" />
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('nomUser')" onmouseout ="javascript:ocultarAyuda('nomUser')">a</a></b>
                            <span class="popuptext" id="nomUser">Ingrese los Nombre del Usuario. Solo es permitido digitos 50 caracteres. !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Apellidos:</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control letras" required="true" size="100" maxlength="50" th:field="*{nombreusuario}" />
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('nomUser')" onmouseout ="javascript:ocultarAyuda('nomUser')">a</a></b>
                            <span class="popuptext" id="nomUser">Ingrese el identificador del Usuario. Solo es permitido digitos 50 caracteres. !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">DUI:</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control numeros" required="true" size="100" maxlength="9" th:field="*{dui}" />
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('dui')" onmouseout ="javascript:ocultarAyuda('dui')">a</a></b>
                            <span class="popuptext" id="dui">Ingrese el DUI del Usuario. Solo es permitido digitos 9 caracteres. !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Contraseña:</label>
                        <div class="col-sm-6">
                            <input type="password" class="form-control" required="true" id = "pass" size="100" maxlength="50" th:field="*{contraseniausuario}"/>
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('passw')" onmouseout ="javascript:ocultarAyuda('passw')">a</a></b>
                            <span class="popuptext" id="passw">Ingrese la Contraseña. Como minimo debe ingresar 8 caracteres . !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Confirmacion de Contraseña:</label>
                        <div class="col-sm-6">
                            <input type="password" id="confpass" class="form-control " required="true" size="11" maxlength="11" th:field="*{controlcontrasenia}"/>
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('passw')" onmouseout ="javascript:ocultarAyuda('passw')">a</a></b>
                            <span class="popuptext" id="passw">Confirme la Contraseña. Como minimo debe ingresar 8 caracteres . !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Fecha Ingreso:</label>
                        <div class="col-sm-2">
                            <input type="text" placeholder="dia/mes/año" class="form-control fecha_format" id="fdesde" th:field="*{fechaingreso}"onchange="isDat(this.value, 'fdesde'); Fechas(this.value, $('#fhasta').val().toString(), 'fdesde', 'fhasta')"/>
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('finicio')" onmouseout ="javascript:ocultarAyuda('finicio')">a</a></b>

                            <span class="popuptext" id="finicio">Ingrese la Fecha inicial de la Contraseña.  . !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Fecha de caducidad:</label>
                        <div class="col-sm-2">
                            <input type="text" class="form-control fecha_format" id="fhasta"  th:field="*{fechacaducidad}" placeholder="dia/mes/año" onchange="isDat(this.value, 'fhasta'); Fechas($('#fdesde').val().toString(), this.value, 'fdesde', 'fhasta')"/>
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('ffinal')" onmouseout ="javascript:ocultarAyuda('ffinal')">a</a></b>

                            <span class="popuptext" id="ffinal">Ingrese la Fecha de Caducidad.  . !!</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Fecha de baja:</label>
                        <div class="col-sm-2">
                            <input type="text" placeholder="dia/mes/año"class="form-control fecha_format" id="fchabaja" th:field="*{fechabaja}"/>
                        </div>
                        <div class="popup col-sm-1"><b>
                                <a id="" class="btnayuda btn btn-info" href="#" onmouseover="javascript:mostrarAyuda('fbajo')" onmouseout ="javascript:ocultarAyuda('fbajo')">a</a></b>

                            <span class="popuptext" id="fbajo">Ingrese la Fecha de Baja.  . !!</span>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="row" align="center">
                            <a href="#" th:href="@{/usuarios/}" class="btn btn-primary glyphicon glyphicon-arrow-left">Regresar</a>
                            <button type="button" id = "guardar" class="btn btn-success"><span class="glyphicon glyphicon-floppy-disk"></span>Guardar</button>
                            <button type="reset" class="btn btn-secondary"><span class="glyphicon glyphicon-erase"></span>Limpiar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

</body>

<script>

    function Fechas(val1, val2, val3, val4){
    var foo = ValidarFecha(val1, val2, val3, val4).split(","); ;
    if (foo[0] != foo[2]){
    swal(foo[1], foo[0]);
    }
    }

    function isDat(val, id){
    var foo = ExisteFecha(val, id).split(","); ;
    if (foo[0] != foo[2]){
    swal(foo[1], foo[0]);
    }
    }
    $(document).ready(function () {
    $('#fdesde').datepicker({
    dateFormat: 'dd/mm/yy'
    });
    $('#fhasta').datepicker({
    dateFormat: 'dd/mm/yy'
    });
    $('#fchabaja').datepicker({
    dateFormat: 'dd/mm/yy'
    });
    });</script>

</body>
<script th:inline="javascript">
    Textheader('pnt_geus', document.title);
    $(document).ready(function () {


    $('#guardar').click(function(){
    var pass = $("#pass").val();
    if (pass == $("#confpass").val()){
    if (pass.length >= 8){
    $("form#usuarioform").submit();
    }
    else{
    swal({
    title: "ERROR!",
            text: "la contraseña debe tener al menos 8 caracteres",
            type: "error",
            icon: "error"
    });
    }
    }
    else {
    swal({
    title: "ERROR!",
            text: "las contraseñas no coinciden",
            type: "error",
            icon: "error"
    });
    }

    });
    if ([[${msg}]] === 0){
    swal({
    title: "Exito! Usuario Generado:"+[[${usuarioname}]],
            text: "Registro agregado correctamente",
            type: "success",
            icon: "success"
    }).then(function() {
    location.href = '../usuarios/';
    });
    }

    if ([[${msg}]] === 1){
    swal({
    title: "ERROR!",
            text: "Ocurrio un error en el proceso",
            type: "error",
            icon: "error"
    });
    }
    });
</script> 


</html>
